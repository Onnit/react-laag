import React__default,{useState,useRef,useEffect,useCallback,createElement,Fragment,useMemo,useLayoutEffect}from"react";import{createPortal}from"react-dom";function _extends(){return(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}function useEvent(e,t,r,n,i){return void 0===n&&(n=!0),void 0===i&&(i=!1),useEffect(function(){if(n&&e){var o=r,a=Array.isArray(e)?e:[e],l=Array.isArray(t)?t:[t];return a.forEach(function(e){l.forEach(function(t){e.addEventListener(t,o,i)})}),function(){a.forEach(function(e){l.forEach(function(t){e.removeEventListener(t,o,i)})})}}},[r,e,n,t,i])}var OutsideClickContext=React__default.createContext({});function isChildOf(e,t){if(e===t)return!0;if(e.children&&e.children.length>0)for(var r=0;r<e.children.length;r++){var n=e.children[r];if(n&&isChildOf(n,t))return!0}return!1}function OutsideClickGroupProvider(e){var t=e.refs,r=e.children;return"function"==typeof React__default.useContext(OutsideClickContext)?r:React__default.createElement(OutsideClickContext.Provider,{value:React__default.useCallback(function(e){t.current.add(e)},[])},r)}function useRegisterGroup(e){var t=React__default.useContext(OutsideClickContext);React__default.useEffect(function(){var r=e.current.values()[0];"function"==typeof t&&r&&t(r)},[t,e])}function useOutsideClick(e,t){var r=React__default.useState(["click"])[0];useRegisterGroup(e),useEvent("undefined"!=typeof document?document:null,r,React__default.useCallback(function(r){var n=e.current,i=Array.isArray(n),o=0;for(n=i?n:n[Symbol.iterator]();;){var a;if(i){if(o>=n.length)break;a=n[o++]}else{if((o=n.next()).done)break;a=o.value}var l=a;if(l.current&&isChildOf(l.current,r.target))return}t()},[t]),!0,!0)}function useOnScroll(e,t,r,n){void 0===n&&(n=!0),useEvent(useMemo(function(){return void 0!==r?[r].concat(e):[]},[e]),"scroll",t,n)}function useOnWindowResize(e,t,r){void 0===r&&(r=!0),useEvent(void 0!==t?t:null,"resize",e,r)}var useIsomorphicLayoutEffect="undefined"!=typeof window?useLayoutEffect:useEffect;function useTrackElementResize(e,t,r,n,i,o){var a=useRef(i);a.current=i;var l=e||(void 0===o?function(){}:o.ResizeObserver);if(!l)throw new Error("This browser does not support `ResizeObserver` out of the box. Please provide a polyfill as a prop.");var c=useRef(new l(function(){t.current&&a.current()}));return useIsomorphicLayoutEffect(function(){n?r&&c.current.observe(r):(r&&c.current.unobserve(r),t.current&&c.current.unobserve(t.current))},[n,r]),useEffect(function(){return function(){c.current.disconnect()}},[]),c.current}var EMPTY_STYLE={};function isSet(e){return void 0!==e&&null!==e}function areStylesTheSame(e,t){var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var i=0;i<Math.max(r.length,n.length);i++){var o=r[i]||n[i];if(e[o]!==t[o])return!1}return!0}function shouldUpdateStyles(e,t){return!areStylesTheSame(e.layer,t.layer)||!areStylesTheSame(e.arrow,t.arrow)}function getWindowClientRect(e){return{top:0,left:0,right:e?e.innerWidth:0,bottom:e?e.innerHeight:0,height:e?e.innerHeight:0,width:e?e.innerWidth:0}}var convertFloat=function(e){return parseFloat(e.replace("px",""))};function getContentBox(e,t){if(!t)return{width:0,height:0};var r=t.getComputedStyle(e),n=r.width,i=r.height,o=r.boxSizing,a=r.borderLeft,l=r.borderRight,c=r.borderTop,u=r.borderBottom,s=r.paddingLeft,f=r.paddingRight,d=r.paddingTop,g=r.paddingBottom;return{width:"border-box"===o?convertFloat(n):[n,a,l,s,f].reduce(function(e,t){return e+(t?convertFloat(t):0)},0),height:"border-box"===o?convertFloat(i):[i,c,u,d,g].reduce(function(e,t){return e+(t?convertFloat(t):0)},0)}}function clientRectToObject(e){return{top:e.top,left:e.left,right:e.right,bottom:e.bottom,width:e.width,height:e.height}}function getElementFromAnchorNode(e){for(var t=e;!t.getBoundingClientRect;){if(!t.parentElement)return null;t=t.parentElement}return t}function minMax(e,t){var r=t.min,n=t.max;return e<r?r:e>n?n:e}function useStyleState(e){var t=useState({layer:EMPTY_STYLE,arrow:EMPTY_STYLE,layerSide:e.split("_")[0].toLowerCase()})[0],r=useState(t),n=r[0],i=r[1],o=useRef(n);return{styles:n,lastStyles:o,setStyles:i,resetLastStyles:function(){o.current=t}}}var Anchor={BOTTOM_LEFT:"BOTTOM_LEFT",BOTTOM_RIGHT:"BOTTOM_RIGHT",BOTTOM_CENTER:"BOTTOM_CENTER",TOP_LEFT:"TOP_LEFT",TOP_CENTER:"TOP_CENTER",TOP_RIGHT:"TOP_RIGHT",LEFT_BOTTOM:"LEFT_BOTTOM",LEFT_CENTER:"LEFT_CENTER",LEFT_TOP:"LEFT_TOP",RIGHT_BOTTOM:"RIGHT_BOTTOM",RIGHT_CENTER:"RIGHT_CENTER",RIGHT_TOP:"RIGHT_TOP"},POSSIBLE_ANCHORS=Object.keys(Anchor);function getPrimaryDirection(e){return e.startsWith("TOP_")||e.startsWith("BOTTOM_")?"Y":"X"}function primaryIsY(e){return"TOP"===e||"BOTTOM"===e}function getPrimaryByIndex(e,t,r,n){var i=primaryIsY(t);return e<3?t:e<6?i?r:n:e<9?i?["LEFT","RIGHT"].filter(function(e){return e!==r})[0]:["TOP","BOTTOM"].filter(function(e){return e!==n})[0]:i?["TOP","BOTTOM"].filter(function(e){return e!==t})[0]:["LEFT","RIGHT"].filter(function(e){return e!==t})[0]}function getSecondaryByIndex(e,t,r,n){var i=primaryIsY(t),o=n.trigger.height>n.layer.height,a=n.trigger.width>n.layer.width;switch(e){case 9:case 0:return r;case 1:case 10:return"CENTER"===r?i?"RIGHT":"BOTTOM":"CENTER";case 4:case 7:return"CENTER";case 2:case 11:return i?["LEFT","RIGHT"].filter(function(e){return e!==r})[0]:["TOP","BOTTOM"].filter(function(e){return e!==r})[0];case 3:case 6:return i?"BOTTOM"===t?o?"BOTTOM":"TOP":o?"TOP":"BOTTOM":"LEFT"===t?a?"LEFT":"RIGHT":a?"RIGHT":"LEFT";case 5:case 8:return i?"BOTTOM"===t?o?"TOP":"BOTTOM":o?"BOTTOM":"TOP":"LEFT"===t?a?"RIGHT":"LEFT":a?"LEFT":"RIGHT"}return"LEFT"}function getSecondaryAnchorOptionsByPrimary(e,t){return t.filter(function(t){return t.startsWith(e)})}function splitAnchor(e){var t=e.split("_");return{primary:t[0],secondary:t[1]}}function getLayerSideByAnchor(e){return"CENTER"===e?"center":splitAnchor(e).primary.toLowerCase()}function getAnchorPriority(e,t,r,n,i){var o="CENTER"!==e?splitAnchor(e):{primary:n,secondary:"CENTER"},a=o.primary,l=o.secondary,c=POSSIBLE_ANCHORS.map(function(e,t){return getPrimaryByIndex(t,a,r,n)+"_"+getSecondaryByIndex(t,a,l,i)}).filter(function(e){return t.indexOf(e)>-1});return-1===c.indexOf(e)&&(c=[e].concat(c)),c}function getPrimaryStyle(e,t,r,n){var i,o,a="TOP"===e||"BOTTOM"===e?"top":"left",l="TOP"===e||"BOTTOM"===e?"height":"width";return"TOP"===e||"LEFT"===e?((o={})[a]=t.trigger[a]-t.layer[l]-(t.relativeParent[a]-r[a])-n,o):((i={})[a]=t.trigger[a]+t.trigger[l]-(t.relativeParent[a]-r[a])+n,i)}function getCenter(e,t,r,n,i){return minMax(e.trigger[n]-e.relativeParent[n]+t[n]+e.trigger[i]/2-e.layer[i]/2-r,getLimits(e,t)[n])}function getLimits(e,t){var r=e.trigger.top-e.relativeParent.top+t.top,n=e.trigger.left-e.relativeParent.left+t.left;return{top:{min:r-(e.layer.height-e.arrow.height),max:r+(e.trigger.height-e.arrow.height)},left:{min:n-(e.layer.width-e.arrow.width),max:n+(e.trigger.width-e.arrow.width)}}}function getSecondaryStyle(e,t,r,n,i){var o;if("CENTER"===e){var a,l="X"===i?"top":"left";return(a={})[l]=getCenter(t,r,n,l,"X"===i?"height":"width"),a}var c,u="TOP"===e||"BOTTOM"===e?"top":"left",s="TOP"===e||"BOTTOM"===e?"height":"width";return"TOP"===e||"LEFT"===e?((c={})[u]=minMax(t.trigger[u]-t.relativeParent[u]+r[u]+n,getLimits(t,r)[u]),c):((o={})[u]=minMax(t.trigger[u]+t.trigger[s]-t.layer[s]-(t.relativeParent[u]-r[u])-n,getLimits(t,r)[u]),o)}function getAbsolutePositions(e){var t=e.anchor,r=e.rects,n=e.triggerOffset,i=e.offsetSecondary,o={left:e.scrollLeft,top:e.scrollTop};if("CENTER"===t)return{top:getCenter(r,o,0,"top","height"),left:getCenter(r,o,0,"left","width")};var a=splitAnchor(t),l=a.primary,c=a.secondary,u=getPrimaryDirection(t);return _extends({},getPrimaryStyle(l,r,o,n),{},getSecondaryStyle(c,r,o,i,u))}function fixLayerDimensions(e,t,r){var n="function"==typeof r?r(getLayerSideByAnchor(t)):r;return _extends({},clientRectToObject(e),{},n)}var propMap={TOP:{side1:"bottom",side2:"top",size:"height",factor:-1},BOTTOM:{side1:"top",side2:"bottom",size:"height",factor:1},LEFT:{side1:"right",side2:"left",size:"width",factor:-1},RIGHT:{side1:"left",side2:"right",size:"width",factor:1}};function getPrimaryRect(e,t,r,n){var i,o=propMap[e],a=o.side1,l=o.side2,c=o.size,u=o.factor,s=t[l]+n*u;return(i={})[a]=s,i[l]=s+r[c]*u,i}function getCenter$1(e,t,r,n,i){var o,a=e[n]+e[i]/2-t[i]/2-r;return(o={})[n]=a,o["left"===n?"right":"bottom"]=a+t[i],o}function getSecondaryRect(e,t,r,n,i){var o;if("CENTER"===e)return getCenter$1(t,r,n,"X"===i?"top":"left","X"===i?"height":"width");var a=propMap[e],l=a.side1,c=a.side2,u=a.size,s=a.factor,f=t[c]-n*s;return(o={})[c]=f,o[l]=f-r[u]*s,o}function getLayerRectByAnchor(e){var t,r,n=e.trigger,i=e.layer,o=e.anchor,a=e.triggerOffset,l=e.scrollOffset,c=void 0===l?0:l,u=e.offsetSecondary,s=void 0===u?0:u,f=e.layerDimensions,d=f?fixLayerDimensions(i,o,f):i;if("CENTER"===o)t=getCenter$1(n,d,0,"top","height"),r=getCenter$1(n,d,0,"left","width");else{var g=splitAnchor(o),h=g.primary,p=g.secondary,y=getPrimaryDirection(o);t=getPrimaryRect(h,n,d,a),r=getSecondaryRect(p,n,d,s,y)}var m=_extends({},d,{},t,{},r);return m.top=m.top-c,m.right=m.right+c,m.left=m.left-c,m.bottom=m.bottom+c,m}var ALL_OFFSET_SIDES=["bottom","top","left","right"];function getLayerOffsetsToParent(e,t){return{top:e.top-t.top,bottom:t.bottom-e.bottom,left:e.left-t.left,right:t.right-e.right}}function getLayerOffsetsToParents(e,t){return t.map(function(t){return getLayerOffsetsToParent(e,t)})}function isLayerCompletelyInvisible(e,t){return t.some(function(t){return e.bottom<=t.top||e.right<=t.left||e.top>=t.bottom||e.left>=t.right})}function doesEntireLayerFitWithinScrollParents(e,t){return getLayerOffsetsToParents(e,t).every(function(e){return ALL_OFFSET_SIDES.every(function(t){return e[t]>=0})})}function reduceOffsets(e){var t=e.reduce(function(e,t){return ALL_OFFSET_SIDES.forEach(function(r){e[r]=[].concat(e[r],[t[r]])}),e},{top:[],bottom:[],left:[],right:[]});return ALL_OFFSET_SIDES.reduce(function(e,r){return e[r]=t[r].sort(function(e,t){return e-t})[0],e},{})}function getNegativeOffsetSides(e){var t=reduceOffsets(e);return ALL_OFFSET_SIDES.filter(function(e){return t[e]<0})}function getVisibleLayerSurface(e,t){var r=getLayerOffsetsToParent(e,t),n=ALL_OFFSET_SIDES.filter(function(e){return r[e]<0}).reduce(function(e,t){var n,i="top"===t||"bottom"===t?"height":"width";return _extends({},e,((n={})[i]=e[i]+r[t],n))},e),i=n.width,o=n.height,a=i*o;return i<0&&o<0?-a:a}function getVisibleLayerSurfaceWithinScrollParent(e,t){return t.map(function(t){return getVisibleLayerSurface(e,t)}).sort(function(e,t){return e-t})[0]}function doesAnchorFitWithinScrollParents(e,t,r,n,i){return doesEntireLayerFitWithinScrollParents(getLayerRectByAnchor({anchor:e,trigger:t.trigger,layer:t.layer,triggerOffset:r,scrollOffset:n,layerDimensions:i}),t.scrollParents)}function getLayerOffsetsToScrollParentsByAnchor(e,t,r,n){return getLayerOffsetsToParents(getLayerRectByAnchor({anchor:e,trigger:t.trigger,layer:t.layer,triggerOffset:r,scrollOffset:n,layerDimensions:null}),t.scrollParents)}function triggerIsBiggerThanLayer(e,t,r){return("top"===e||"bottom"===e)&&r.width>t.width||("left"===e||"right"===e)&&r.height>t.height}function getOffsetSurface(e,t,r,n){var i=getPrimaryDirection(e);return(t["X"===i?"width":"height"]-r-2*n)*(t["X"===i?"height":"width"]-r-2*n)}function findAnchorByLayerSurface(e,t,r,n,i){return t.map(function(t){var o=getLayerRectByAnchor({anchor:t,layer:e.layer,trigger:e.trigger,scrollOffset:n,triggerOffset:r,layerDimensions:i});return{anchor:t,square:getVisibleLayerSurfaceWithinScrollParent(o,e.scrollParents)-getOffsetSurface(t,o,r,n)}}).sort(function(e,t){return t.square-e.square})[0].anchor}function findBestSuitableAnchor(e,t,r,n,i){var o=t.find(function(t){return doesAnchorFitWithinScrollParents(t,e,r,n,i)});return o||findAnchorByLayerSurface(e,t,r,n,i)}function getSecondaryOffsetSide(e,t,r,n,i){var o=getPrimaryDirection(e);return getNegativeOffsetSides(getLayerOffsetsToScrollParentsByAnchor(t,r,n,i)).find(function(e){return"X"===o?"top"===e||"bottom"===e:"left"===e||"right"===e})}function findSecondaryOffset(e,t,r,n,i){var o=getSecondaryAnchorOptionsByPrimary(splitAnchor(e).primary,t),a=0===o.indexOf(e),l=doesAnchorFitWithinScrollParents(e,r,n,i,null);if(a&&l)return 0;var c=getSecondaryOffsetSide(e,o.find(function(e){return!doesAnchorFitWithinScrollParents(e,r,n,i,null)}),r,n,i);if(!c)return 0;var u=-reduceOffsets(getLayerOffsetsToScrollParentsByAnchor(e,r,n,i))[c],s=triggerIsBiggerThanLayer(getLayerSideByAnchor(e),r.layer,r.trigger),f=e.includes("_CENTER"),d=e.includes("_LEFT"),g=e.includes("_TOP");return s&&(d&&"right"===c||"left"===c||g&&"bottom"===c||"top"===c)?u=-u:s||!f||"top"!==c&&"left"!==c||(u=-u),u}function getOffsets(e,t,r){var n=e.left+e.width/2-t.left-r.width/2,i=e.right-e.width/2-t.right+r.width/2,o=e.top+e.height/2-t.top-r.height/2,a=e.bottom-e.height/2-t.bottom+r.height/2;return{left:n<0?-n:0,right:i>0?-i:0,top:o<0?-o:0,bottom:a>0?-a:0}}function getArrowStyle(e,t,r,n){var i=triggerIsBiggerThanLayer(r,e,t),o={left:{min:n.width/2,max:e.width-n.width/2},top:{min:n.height/2,max:e.height-n.height/2}},a=getOffsets(e,t,n);return"bottom"===r?{bottom:"100%",top:null,left:minMax(i?e.width/2+(a.left+a.right):t.left+t.width/2-e.left,o.left),right:null}:"right"===r?{right:"100%",left:null,top:minMax(i?e.height/2+(a.top+a.bottom):t.top+t.height/2-e.top,o.top),bottom:null}:"top"===r?{top:"100%",bottom:null,left:minMax(i?e.width/2+(a.left+a.right):t.left+t.width/2-e.left,o.left),right:null}:{left:"100%",right:null,top:minMax(i?e.height/2+(a.top+a.bottom):t.top+t.height/2-e.top,o.top),bottom:null}}function getAbsoluteStyle(e){var t=e.rects,r=e.scrollTop,n=e.scrollLeft,i=e.triggerOffset,o=e.scrollOffset,a=e.possibleAnchors,l=e.preferedAnchor,c=e.preferedX,u=e.preferedY,s=e.autoAdjust,f=e.snapToAnchor,d=e.layerDimensions,g=getAnchorPriority(l,a,c,u,t),h=s?findBestSuitableAnchor(t,g,i,o,d):l,p=s&&!f&&"CENTER"!==h?findSecondaryOffset(h,g,t,i,o):0,y=getAbsolutePositions({anchor:h,rects:t,triggerOffset:i,offsetSecondary:p,scrollLeft:n,scrollTop:r}),m=getLayerRectByAnchor({anchor:h,trigger:t.trigger,layer:t.layer,triggerOffset:i,offsetSecondary:p,layerDimensions:d});return d&&(y.width=m.width,y.height=m.height),{layerStyle:y,layerRect:m,anchor:h}}function compensateScrollbars(e,t,r){var n=e.width-t,i=e.height-r;return{left:e.left,top:e.top,width:e.width-n,right:e.right-n,height:e.height-i,bottom:e.bottom-i}}function getArrowRect(e,t){var r=e.querySelector("[data-arrow]");if(!r)return{top:0,bottom:0,left:0,right:0,width:0,height:0};var n=r.getBoundingClientRect();return _extends({},clientRectToObject(n),{width:n.width+2*t,height:n.height+2*t})}var defaultPlacement={autoAdjust:!1,snapToAnchor:!1,anchor:"TOP_CENTER",layerDimensions:null,possibleAnchors:POSSIBLE_ANCHORS,preferX:"RIGHT",preferY:"BOTTOM",scrollOffset:10,triggerOffset:0,arrowOffset:0};function getPositioning(e){var t=e.triggerRect,r=e.layerElement,n=e.relativeParentElement,i=e.scrollParents,o=e.placement,a=void 0===o?{}:o,l=e.environment,c=e.fixed;if(0!==t.height&&r){var u=c?[getWindowClientRect(l)]:[].concat(i.map(function(e){return compensateScrollbars(e.getBoundingClientRect(),e.clientWidth,e.clientHeight)}),[getWindowClientRect(l)]),s={autoAdjust:a.autoAdjust||defaultPlacement.autoAdjust,snapToAnchor:a.snapToAnchor||defaultPlacement.snapToAnchor,triggerOffset:isSet(a.triggerOffset)?a.triggerOffset:defaultPlacement.triggerOffset,scrollOffset:isSet(a.scrollOffset)?a.scrollOffset:defaultPlacement.scrollOffset,possibleAnchors:a.possibleAnchors||defaultPlacement.possibleAnchors,preferedAnchor:a.anchor||defaultPlacement.anchor,preferedX:a.preferX||defaultPlacement.preferX,preferedY:a.preferY||defaultPlacement.preferY,scrollLeft:n===document.body?0:n.scrollLeft,scrollTop:n===document.body?0:n.scrollTop,relativeParentElement:n,layerDimensions:a.layerDimensions||defaultPlacement.layerDimensions},f=r.getBoundingClientRect(),d={layer:_extends({top:f.top,left:f.left,right:f.right,bottom:f.bottom},getContentBox(r,l)),relativeParent:n.getBoundingClientRect(),scrollParents:u,trigger:t,arrow:getArrowRect(r,a.arrowOffset||defaultPlacement.arrowOffset)},g=getAbsoluteStyle(_extends({rects:d},s)),h=g.layerRect,p=g.layerStyle,y=g.anchor;c&&(p.top=h.top,p.left=h.left);var m=getLayerSideByAnchor(y);return{styles:{layer:p,arrow:"CENTER"===y?EMPTY_STYLE:getArrowStyle(h,t,m,d.arrow),layerSide:m},layerRect:h}}}function useElementRef(e,t){var r=useState(e||null),n=r[0],i=r[1],o=useRef(null);return[useCallback(function(e){e&&e!==o.current&&(o.current=e,i(t?t(e):e))},[]),n,o]}function findScrollContainers(e,t){var r=[];if(!e||!t)return r;if(e===document.body)return r;var n=t.getComputedStyle(e);return[n.overflow,n.overflowX,n.overflowY].some(function(e){return"auto"===e||"scroll"===e})&&r.push(e),[].concat(r,findScrollContainers(e.parentElement,t))}function useElementState(e,t,r){return useElementRef({triggerElement:null,relativeParentElement:null,scrollParents:[]},useCallback(function(n){var i=findScrollContainers(n,r),o=i[0]||document.body;if(o===document.body)document.body.style.position="relative";else if("development"===process.env.NODE_ENV&&r){var a="function"==typeof e?e():e,l=r.getComputedStyle(o).position;"relative"!==l&&"absolute"!==l&&"fixed"!==l&&!t&&!a&&console.error("react-laag: Set the 'position' style of the nearest scroll-container to 'relative', 'absolute' or 'fixed', or set the 'fixed' prop to true. This is needed in order to position the layers properly. Currently the scroll-container is positioned: \""+l+'". Visit https://react-laag.com/docs/#position-relative for more info.',o)}return{triggerElement:n,relativeParentElement:o,scrollParents:i}},[]))}function useIsOpen(e,t){var r=useRef(t),n=!r.current&&(isSet(t)?t:e),i=useState(!1)[1];return useEffect(function(){r.current&&(r.current=!1,i(!0))},[]),n}function ToggleLayer(e){var t=e.children,r=e.renderLayer,n=e.placement,i=void 0===n?{}:n,o=e.onStyle,a=e.isOpen,l=e.closeOnOutsideClick,c=e.onOutsideClick,u=e.onDisappear,s=e.closeOnDisappear,f=e.fixed,d=e.container,g=e.environment,h=void 0===g?"undefined"!=typeof window?window:void 0:g,p=_objectWithoutPropertiesLoose(e,["children","renderLayer","placement","onStyle","isOpen","closeOnOutsideClick","onOutsideClick","onDisappear","closeOnDisappear","fixed","container","environment"]),y=useElementState(d,f,h),m=y[0],v=y[1],T=v.relativeParentElement,O=v.triggerElement,S=v.scrollParents,E=y[2],w=useStyleState(i.anchor||defaultPlacement.anchor),P=w.styles,L=w.setStyles,R=w.lastStyles,b=w.resetLastStyles,C=useRef(null),_=useState(!1),B=_[0],A=_[1],x=useIsOpen(B,a),M=useCallback(function(){if(!O)throw new Error("Could not find a valid reference of the trigger element. See https://www.react-laag.com/docs/togglelayer/#children for more info.");var e=O.getBoundingClientRect(),t=getPositioning({triggerRect:e,layerElement:C.current,placement:i,relativeParentElement:T,scrollParents:S,fixed:f,environment:h});if(t){var r=t.layerRect,n=t.styles;shouldUpdateStyles(R.current,n)&&(isSet(o)?(R.current=n,o(n.layer,n.arrow,n.layerSide)):L(n));var l=isSet(u),c=s&&!isSet(a);if(l||c){var d=[].concat(S.map(function(e){return e.getBoundingClientRect()}),[getWindowClientRect(h)]),g=!doesEntireLayerFitWithinScrollParents(f?e:r,d),p=isLayerCompletelyInvisible(f?e:r,d);l?(g||p)&&u(p?"full":"partial"):("partial"===s&&g&&A(!1),"full"===s&&p&&A(!1))}}},[T,x,O,S,f,i]),F=useTrackElementResize(p.ResizeObserver,C,O,x,M,h);useIsomorphicLayoutEffect(function(){var e=!isSet(o);P!==R.current&&e?R.current=P:x?M():b()}),useOnWindowResize(M,h,x),useOnScroll(S,M,h,x);var I=useRef(new Set([C,E]));useOutsideClick(I,useCallback(function(){x&&(c&&c(),l&&!isSet(a)&&A(!1))},[x,A,a,c]));var k="function"==typeof d?d():d;return createElement(Fragment,null,t({isOpen:x,close:function(){if(isSet(a))throw new Error("You cannot call `close()` while using the `isOpen` prop");A(!1)},open:function(){if(isSet(a))throw new Error("You cannot call `open()` while using the `isOpen` prop");A(!0)},toggle:function(){if(isSet(a))throw new Error("You cannot call `toggle()` while using the `isOpen` prop");A(!B)},triggerRef:m,layerSide:x?P.layerSide:null}),T&&createElement(OutsideClickGroupProvider,{refs:I},createPortal(r({layerProps:{ref:function(e){e&&F.observe(e),C.current=e},style:_extends({},isSet(o)?EMPTY_STYLE:P.layer,{position:f?"fixed":"absolute",willChange:"top, bottom, left, right, width, height"})},arrowStyle:_extends({},isSet(o)?EMPTY_STYLE:P.arrow,{position:"absolute",willChange:"top, bottom, left, right"}),isOpen:x,layerSide:P.layerSide,triggerRect:O?O.getBoundingClientRect():null,close:function(){if(isSet(a))throw new Error("You cannot call `close()` while using the `isOpen` prop");A(!1)}}),k||T)))}function getWidthBasedOnAngle(e,t){return Math.tan(e*(Math.PI/180))*t}function getViewBox(e,t,r,n){switch(r){case"bottom":return"0 "+-n+" "+t+" "+e;case"top":return"0 0 "+t+" "+(e+n);case"right":return-n+" 0 "+e+" "+t;case"left":return"0 0 "+(e+n)+" "+t}return""}function getTrianglePath(e){var t=e.sizeA,r=e.sizeB,n=e.layerSide,i=e.roundness,o=e.angle,a=i/10*t*2,l="bottom"===n?"0 "+t:"top"===n?"0 0":"right"===n?t+" "+r:"0 "+r,c=("bottom"===n||"top"===n?"H":"V")+" "+("bottom"===n||"top"===n?r:0),u=r/2,s=r/2+getWidthBasedOnAngle(o,t/8),f=t/8,d="bottom"===n?"C "+s+" "+f+" "+(u+a)+" 0 "+u+" 0":"top"===n?"C "+s+" "+(t-f)+" "+(u+a)+" "+t+" "+u+" "+t:"right"===n?"C "+f+" "+(r-s)+" 0 "+(u-a)+" 0 "+u:"C "+(t-f)+" "+(r-s)+" "+t+" "+(u-a)+" "+t+" "+u,g=r/2-getWidthBasedOnAngle(o,t/8),h=t/8;return"M "+l+" "+c+" "+d+" "+("bottom"===n?"C "+(u-a)+" 0 "+g+" "+h+" "+l:"top"===n?"C "+(u-a)+" "+t+" "+g+" "+(t-h)+" "+l:"right"===n?"C 0 "+(u+a)+" "+h+" "+(r-g)+" "+l:"C"+t+" "+(u+a)+" "+(t-h)+" "+(r-g)+" "+l)}function getBorderMaskPath(e){var t=e.sizeA,r=e.sizeB,n=e.borderWidth,i=e.layerSide,o=getWidthBasedOnAngle(e.angle,n);return"bottom"===i||"top"===i?"M "+n+" "+("bottom"===i?t:0)+" H "+(r-n)+" L "+(r-n-o)+" "+("bottom"===i?t-n:n)+" H "+(o+n)+" Z":"M "+("right"===i?t:0)+" "+n+" V "+(r-n)+" L "+("right"===i?t-n:n)+" "+(r-n-o)+" V "+(o+n)+" Z"}function Arrow(e){var t=e.size,r=void 0===t?8:t,n=e.angle,i=void 0===n?45:n,o=e.borderWidth,a=void 0===o?0:o,l=e.borderColor,c=void 0===l?"black":l,u=e.roundness,s=void 0===u?0:u,f=e.backgroundColor,d=void 0===f?"white":f,g=e.layerSide,h=void 0===g?"top":g,p=e.style,y=void 0===p?{}:p;if("center"===h)return null;var m=r,v=2*getWidthBasedOnAngle(i,r);return createElement("svg",{style:_extends({},y,{transform:"translate"+("left"===h||"right"===h?"Y":"X")+"(-50%)"}),"data-arrow":"true",width:"left"===h||"right"===h?m:v,viewBox:getViewBox(m,v,h,a)},createElement("path",{fill:d,strokeWidth:a,stroke:c,d:getTrianglePath({angle:i,layerSide:h,roundness:s,sizeA:m,sizeB:v})}),createElement("path",{fill:d,d:getBorderMaskPath({sizeA:m,sizeB:v,angle:i,borderWidth:a,layerSide:h})}))}function useToggleLayer(e,t){void 0===t&&(t={});var r=t,n=r.onStyle,i=r.closeOnOutsideClick,o=r.closeOnDisappear,a=r.fixed,l=r.container,c=r.placement,u=void 0===c?{}:c,s=r.environment,f=void 0===s?"undefined"!=typeof window?window:void 0:s,d=_objectWithoutPropertiesLoose(r,["onStyle","closeOnOutsideClick","closeOnDisappear","fixed","container","placement","environment"]),g=useElementState(l,a,f),h=g[0],p=g[1],y=p.relativeParentElement,m=p.triggerElement,v=p.scrollParents,T=g[2],O=useStyleState(u.anchor||defaultPlacement.anchor),S=O.styles,E=O.setStyles,w=O.lastStyles,P=O.resetLastStyles,L=useRef(null),R=useRef(null);function b(){return"function"==typeof R.current?R.current():R.current}var C=useState(!1),_=C[0],B=C[1];function A(){R.current=null,B(!1)}var x=useCallback(function(){var e=b();if(e){var t=getPositioning({triggerRect:e,layerElement:L.current,placement:u,relativeParentElement:y,scrollParents:v,fixed:a,environment:f});if(t){var r=t.layerRect,i=t.styles;if(shouldUpdateStyles(w.current,i)&&(isSet(n)?(w.current=i,n(i.layer,i.arrow,i.layerSide)):E(i)),o){var l=[].concat(v.map(function(e){return e.getBoundingClientRect()}),[getWindowClientRect(f)]),c=!doesEntireLayerFitWithinScrollParents(a?e:r,l),s=isLayerCompletelyInvisible(a?e:r,l);"partial"===o&&c&&A(),"full"===o&&s&&A()}}}},[y,_,m,v,a,u]),M=useTrackElementResize(d.ResizeObserver,L,m,_,x,f);useIsomorphicLayoutEffect(function(){var e=!isSet(n);S!==w.current&&e?w.current=S:_?x():P()}),useOnWindowResize(x,f,_),useOnScroll(v,x,f,_);var F=useRef(new Set([L,T]));useOutsideClick(F,useCallback(function(){_&&i&&A()},[_,B,i]));var I="function"==typeof l?l():l;function k(e){var t=e.clientRect,r=e.target;R.current=t,_&&r===m?x():(h(r),B(!0))}var W={isOpen:_,close:A,open:k,openFromContextMenuEvent:function(e){e.preventDefault();var t=e.target;k({clientRect:{top:e.clientY,left:e.clientX,bottom:e.clientY+1,right:e.clientX+1,width:1,height:1},target:t})},openFromMouseEvent:function(e){var t=e.currentTarget;if(t&&t.getBoundingClientRect){k({clientRect:function(){return t.getBoundingClientRect()},target:t})}},openFromRef:function(e){e.current?k({target:e.current,clientRect:e.current.getBoundingClientRect()}):console.error("Error inside useTooltip(): Expected a valid ref to a trigger element, but got "+typeof e.current)},openFromSelection:function(e){if(e.anchorNode&&!e.isCollapsed){var t=getElementFromAnchorNode(e.anchorNode);if(t){var r=e.getRangeAt(0);k({clientRect:function(){return r.getBoundingClientRect()},target:t})}}},layerSide:_?S.layerSide:null},H=y&&createPortal(e({layerProps:{ref:function(e){e&&M.observe(e),L.current=e},style:_extends({},isSet(n)?EMPTY_STYLE:S.layer,{position:a?"fixed":"absolute",willChange:"top, bottom, left, right, width, height"})},arrowStyle:_extends({},isSet(n)?EMPTY_STYLE:S.arrow,{position:"absolute",willChange:"top, bottom, left, right"}),isOpen:_,layerSide:S.layerSide,triggerRect:b(),close:function(){A()}}),I||y);return[createElement(OutsideClickGroupProvider,{refs:F},H),W]}function useHover(e){var t=e||{},r=t.delayEnter,n=void 0===r?0:r,i=t.delayLeave,o=void 0===i?0:i,a=t.hideOnScroll,l=void 0===a||a,c=t.onShow,u=t.onHide,s=useState(!1),f=s[0],d=s[1],g=useRef(null),h=useRef(null),p=useRef(!1);function y(e){if(e)return c&&c(),void d(!0);u&&u(),d(!1)}useEffect(function(){var e=g.current;function t(){g.current&&(clearTimeout(g.current),g.current=null)}function r(){f&&l&&(t(),y(!1))}function n(){f&&(t(),y(!1))}return window.addEventListener("scroll",r,!0),window.addEventListener("touchend",n,!0),function(){window.removeEventListener("scroll",r,!0),window.removeEventListener("touchend",n,!0),e&&clearTimeout(e)}},[f,l]);var m={onMouseEnter:function(){"leaving"===h.current&&g.current&&(clearTimeout(g.current),g.current=null,h.current=null),f||(h.current="entering",g.current=setTimeout(function(){y(!0),g.current=null,h.current=null},n))},onMouseLeave:function(){"entering"===h.current&&g.current&&(clearTimeout(g.current),g.current=null),f&&(h.current="leaving",g.current=setTimeout(function(){y(!1),g.current=null},o))},onTouchStart:function(){p.current=!1},onTouchMove:function(){p.current=!0},onTouchEnd:function(){p.current||f||y(!0),p.current=!1}};return c?m:[f,m]}function useBreakpoint(e){var t=useState("undefined"!=typeof window&&window.matchMedia("(max-width: "+e+"px)").matches),r=t[0],n=t[1];return useEffect(function(){var t=window.matchMedia("(max-width: "+e+"px)");function r(e){n(e.matches)}return t.addListener(r),function(){t.removeListener(r)}},[e]),r}function Transition(e){var t=e.isOpen,r=e.children,n=useState({isOpenInternal:t,isLeaving:!1}),i=n[0],o=n[1],a=useRef(!1);return useEffect(function(){t?o({isOpenInternal:!0,isLeaving:!1}):a.current&&o({isOpenInternal:!1,isLeaving:!0})},[t,o]),useEffect(function(){a.current=!0},[]),t||i.isOpenInternal||i.isLeaving?r(i.isOpenInternal,function(){i.isOpenInternal||o(function(e){return _extends({},e,{isLeaving:!1})})},i.isLeaving):null}function useTooltip(e,t){void 0===t&&(t={});var r=t,n=r.delayEnter,i=r.delayLeave,o=r.hideOnScroll,a=_objectWithoutPropertiesLoose(r,["delayEnter","delayLeave","hideOnScroll"]),l=useRef(),c=useToggleLayer(e,a),u=c[0],s=c[1],f=s.openFromRef,d=useHover({delayEnter:n,delayLeave:i,hideOnScroll:o,onShow:function(){return f(l)},onHide:s.close});return[u,_extends({ref:l},d)]}export{ToggleLayer,Arrow,useToggleLayer,Anchor as anchor,useHover,useBreakpoint,Transition,useTooltip};